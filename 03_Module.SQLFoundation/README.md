Задание:
Для выполнения задания необходимо подключение к базе данных "DB_dvdrental". Инструкция по подключению указана на странице курса "Установка необходимого ПО".

Часть 1. SQL
Напишите запросы:

Выведите в алфавитном порядке названия комедий, выпущенных в период с 2000 по 2004 год. (1 балл)

Доход (revenue) магазинов проката в 2017 году (колонки address и address2 – как одна строка, revenue), фильтрация по payment_date. (1 балл)

Top-3 актеров по числу фильмов, в которых они приняли участие (колонки first_name, last_name, number_of_movies ), сортировка по числу фильмов в порядке уменьшения. (1 балл)

Количество комедий, боевиков и фильмов ужасов по годам (в строке: год, количество комедий, количество ужасов и количество боевиков), отсортировано по убыванию лет. (1 балл)

Актер, который снимался дольше остальных (в строке полное имя актера/актрисы, год выхода последнего фильма). (1 балл)

Список актеров (колонки first_name, last_name), которые не снимались в фильмах 2020 года. Используйте в запросе CTE и LEFT JOIN. (1 балл)

Напишите запрос для категоризации платежей как "Low" или "High", в зависимости от того, больше они или меньше среднего значения платежа (колонки payment_id, amount, payment_category). Используйте в запросе CASE, оконные функции. (1 балл)

Cписок клиентов (customer, колонки first_name, last_name), бравших ранее в прокат фильмы категории «Action», но не бравших фильмы из категории "Family". Используйте один из SET операторов. (1 балл)

Выведите список клиентов (customer, колонки first_name, last_name) и актеров (actor, колонки first_name, last_name) в одном запросе с указанием типа: "Actor" или "Customer". В результате вывода должны быть колонки: first_name, last_name, person_type. Отсортируйте список по last_name и first_name. (1 балл)

Выведите список клиентов (customer, колонки first_name, last_name), название фильма и его рейтинг проката. Если значение рейтинга - NULL, выведите значение "Not Specified". Отсортируйте список в порядке убывания рейтинга. (1 балл)

Используя таблицы «customer» и «payment», напишите запрос для вычисления средней суммы платежа для каждого клиента за 2017 год. Результат должен включать столбцы для customer_id, «customer_full_name» (first_name, last_name), средней суммы платежа. (1 балл)